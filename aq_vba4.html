<!DOCTYPE HTML>
<!--
	Designed by Ally Qi
-->
<html lang="en">
	<head>
		<title>Ally Qi</title>
		<meta name="keywords" content="Ally Qi, Clinical Data Programmer"/>
		<meta name="description" content="Profolio Website">
    	<meta name="author" content="Ally Qi">
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<!-- CSS only -->	
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

		<!-- Favicons -->
		<link rel="apple-touch-icon" href="/docs/5.0/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
		<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
		<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
		<link rel="manifest" href="/docs/5.0/assets/img/favicons/manifest.json">
		<link rel="mask-icon" href="/docs/5.0/assets/img/favicons/safari-pinned-tab.svg" color="#7952b3">
		<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon.ico">
		<meta name="theme-color" content="#7952b3">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
    

	</head>

	<body data-new-gr-c-s-check-loaded="14.993.0" data-gr-ext-installed="">
		

	<!-- Header -->
			<div id="header">

	<!-- Logo -->
				<h1 class="container-fluid"><a href="index.html"><img src="images/LinkedInBannerAQ.png" alt="AQ" class="img-fluid"></a></h1>
				
	<!-- Navbar -->
				<nav class="navbar navbar-expand-md navbar-dark bg-primary">
					<div class="container-fluid">
						<a class="navbar-brand" href="index.html">
							<img src="images/Logo.AQ.png" alt="" width="80" height="80">
						</a>
						<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
							<span class="navbar-toggler-icon"></span>
						</button>
					   <div class="collapse navbar-collapse" id="navbarsExampleDefault">

							<ul class="navbar-nav me-auto mb-2 mb-md-0">
							<li class="nav-item">
								<a class="nav-link" href="index.html">Home</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="aq_curriculum.html">CV</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="aq_pricing.html">Pricing</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="aq_research.html">Research</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="aq_resources.html">Resources</a>
							</li>
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle active" href="" id="dropdown01" data-bs-toggle="dropdown" aria-expanded="false" aria-current="page">Tutorials 
									<span class="badge bg-success">6</span></a>
								<ul class="dropdown-menu" aria-labelledby="dropdown01">
								<li><a class="dropdown-item active" href="aq_vba.html">Excel VBA <span class="badge bg-warning">4</span></a></li>
								<li><a class="dropdown-item" href="#">Power BI <span class="badge bg-info">2</span></a></li>
								<li><a class="dropdown-item" href="#">Tableau</a></li>
								<li><a class="dropdown-item" href="#">Python</a></li>
								<li><a class="dropdown-item" href="#">STATA</a></li>
								<li><a class="dropdown-item" href="#">HTML5 & Bootstrap</a></li>
								</ul>
							</li>
							</ul>
							<form class="d-flex">
							<input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
							<button class="btn btn-outline-info" type="submit">Search</button>
							</form>
					    </div>
				   </div>
				</nav>
			</div>	
	  
	  <!-- Main Content -->
		<main class="container">
		
			<div class="starter-template text-center py-5 px-3">
			<h1>Welcome to my website!</h1>
			<p class="lead">All my tutorials are here to teach you how to use
				a few lines of codes to automate repetitive tasks which will save us tremendous amount of time.</p>
			</div>

			<article class="blog-post">
				<h2 class="blog-post-title">#4: How to loop through all rows and copy filtered data to a new sheet?</h2>
				<p class="blog-post-meta">Feb 10, 2021</p>
				<p><i>Clinical Research Data 101</i></p>
				<p>Tools/Languages: Excel VBA Macro</p>
		
				<p>This tutorial shows you how to automatically loop through all rows, find the IDs with missing data access group (DAG) names, 
					copy/paste the filtered data to a new sheet and save the new sheet in one click.
				</p>
				<hr>
				<p>It's super helpful if you have more than 100 participants from more than 1 site.<br>
					Or when you need to generate a list of participants with missing site names or numbers.<br>
				</p>
				<p>
					First of all, here's the link to learn how to turn on the 
					<a href="https://www.excel-easy.com/examples/developer-tab.html" target="_blank">"Developer Mode"</a> in your Excel. 
					</b></p>
					<iframe width="560" height="315" src="https://www.youtube.com/embed/ZwFw8IU3mZI" frameborder="0" 
					allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
				</p>

				<h2>What happened?</h2>
				<p>In clinical research, we often need to track participants' status. Usually we would have a spreadsheet of participants IDs with previously
					assigned site numbers. For example, UCLA is site 01 and UC Santa Cruz is site 02, etc. In the electronic data capture system (REDCap), 
					the site numbers should be used as the best indicator for sites, since it's easy to mispell the site names and there're multiple ways 
					to write the same site names. This tutorial is to simulate the situation when you export the report data to Excel spreadsheet as raw data.
				</p>
				<p>
				   In the online EDC, hundreds of records are entered by site coordinators from different institutions, you'd like to quickly generate a list of 
				   participants who have not been assigned to a site (a typical error on the site), knowing that the missing data is coded as either 99 or 0.<br>
				   Your goal is to first find all IDs with missing DAG and then copy the whole row to a new sheet. In this case, you can create a loop to accomplish that.
				</p>
				<h3>What should I do now?</h3>
				<ul>
					<li>Open the Excel spreadsheet and turn on the "Developer" mode as described at the beginning.</li>
					<li>Click "Visual Basic" on the top ribbon (first one on the left).</li>
					<li>Insert a new "Module" and copy/paste the codes below. 
						<pre><code>
Sub FindMissingDAG()

Dim site As Double

Dim dag As String

Dim wb As Workbook

Dim today As String

Dim counter As Integer

Dim intloc As Integer

lastrow = Sheets("Sheet1").Cells(Rows.Count, 1).End(xlUp).Row

counter = 2

today = DateValue(Now)

todaydate = Replace(today, "/", "_")

MsgBox todaydate

'Adding a new sheet named "Missing_DAG"

Sheets.Add(After:=Sheets("Sheet1")).Name = "Missing_DAG"
		
'Copying the heading variables to the new sheet

Worksheets("Missing_DAG").Range("A1:D1").Value = Sheets("Sheet1").Range("A1:D1").Value

'Looping through all rows to find all IDs with missing DAGs (site number: 99 or 0)

For myrow = 2 To lastrow

intloc = Sheets("Sheet1").Range("D" & myrow).Value

If intloc = 99 Or intloc = 0 Then


Worksheets("Missing_DAG").Range("A" & counter & ":D" & counter).Value = Worksheets("Sheet1").Range("A" & myrow & ":D" & myrow).Value


counter = counter + 1
		
Else

End If

Next myrow

'save the file in mac

Worksheets("Missing_DAG").SaveAs "/Users/aq/Desktop/Tutorials/StudyName_Missing_DAG_" & todaydate & ".csv"

End Sub
							
						</code></pre></li>
					<li>Go back to the spreadsheet and click the "Macros" icon on the top ribbon. Then assign the macro to "dag" and click "OK".</li>
				</ul>
				
				<p>Please leave me a message if it doesn't work for you.</p>
				
				<!-- <h3>Sub-heading</h3>
				<p>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>
				<ul>
				<li>Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</li>
				<li>Donec id elit non mi porta gravida at eget metus.</li>
				<li>Nulla vitae elit libero, a pharetra augue.</li>
				</ul>
				<p>Donec ullamcorper nulla non metus auctor fringilla. Nulla vitae elit libero, a pharetra augue.</p>
				<ol>
				<li>Vestibulum id ligula porta felis euismod semper.</li>
				<li>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.</li>
				<li>Maecenas sed diam eget risus varius blandit sit amet non magna.</li>
				</ol>
				<p>Cras mattis consectetur purus sit amet fermentum. Sed posuere consectetur est at lobortis.</p> -->
			</article>

			<!-- Calendly badge widget begin -->
			<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
			<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
			<script type="text/javascript">window.onload = function() { Calendly.initBadgeWidget({ url: 'https://calendly.com/allyqi/30min', text: 'Schedule a call ðŸ¤™', color: '#6621b7', textColor: '#ffffff', branding: false }); }</script>
			<!-- Calendly badge widget end -->




			<!-- Footer -->
			<!-- Copyright  -->
			<footer class="footer mt-auto py-3 bg-light">
				<div class="container">
				<span class="text-muted">Template from <a href="https://github.com/maia1220/allyqi" target="_blank">Ally Qi (2021).</a> All rights reserved.<br>
					Design: <a href="https://getbootstrap.com/">HTML5 & Bootstrap</a>
				</span>
				</div>
			</footer>


</main>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

</body>
</html>
